<?xml version="1.0"?> 
<odoo>

  <!--  Form view for Pubble connector settings and operation --> 
  <record id="view_pubble_kpi_data_connector" model="ir.ui.view">
    <field name="name">Pubble KPI data</field>
    <field name="model">pubble.config</field>
    <field name="arch" type="xml">
      <form string="Pubble KPI data" create="false" edit="false" action="false" 
                                     class="oe_form_configuration">
        <header > 
        </header>

          <br/>
          <group name="connector_config" string="Connector configuration">
            <field name="server"/> 
            <field name="method"/> 
          </group>
          <button name="save_config" type="object" 
            string="Save" class="oe_highlight" /> 
          <br/>
          <br/>


          <group name="production_status" string="Production status">
            <group>
              <field name="latest_issue" readonly="1"/> 
              <field name="latest_run" readonly="1"/> 
              <field name="latest_success" readonly="1"/> 
              <field name="latest_status" readonly="1"/> 
              <field name="latest_reason" readonly="1"/> 
            </group>
            <group>
            </group>
          </group>
          <br/>
          <br/>



          <group name="manual_run" string="Manual collect" >
            <div colspan="2">
              <p>Enter dates and press "Collect" to collect records for given period. </p>
            </div>
            <group>
              <field name="begin"/> 
              <field name="end"/> 
            </group>
            <group>
            </group>
          </group>
          <button string="Collect" name="do_collect" type="object" class="oe_highlight"/>
          <br/>
          <br/>


          <group name="documentation" string="Summary" col="1">
              <p>Pubble provides an API by which we can collect the page usage per issue. </p>
              <p>Normal configuration expects a daily usage by an automation task (see Configuration). Every time the connector collects information from an issue it checks its pressence. This way updates can be retrieved if Pubble administrators are correcting their issue configurations.</p>
              <p>Each page that is explicitly named as an advertisement page is counted as such. In case of a spread it is counted for two. <u>Every other page</u> is counted as an editiorial one. Inherited pages are practically not in use by the time of conception of this software and as such not taken into consideration.</p>              
              <p/>
              <p/>
              <a href="https://www.pubble.nl/" target="_blank"> More about Pubble</a>
          </group>


      </form>
    </field>
  </record> 



  <!-- Connection info via server action and submenu-->
  <record id="config_pubble_kpi_connector" model="ir.actions.server"> 
    <field name="name">Pubble kpi connector</field> 
    <field name="model_id" ref="model_pubble_config"/> 
    <field name="code">
      action = model.default_view()
    </field>
  </record> 

  <!-- Menu item to open KPI connection configuration--> 
  <menuitem id="Pubble KPI connector" 
    name="Pubble connector" 
    action="config_pubble_kpi_connector"
    parent="mis_builder.mis_report_conf_menu" 
    sequence="23"
     /> 
</odoo>



  <!-- Form for record interaction , only for dev 
  <record id="view_tree_kpi_data_connector" model="ir.ui.view"> 
    <field name="name">KPI config list</field> 
    <field name="model">pubble.config</field> 
    <field name="arch" type="xml"> 
      <tree string="KPI data"> 
          <field name="server"/> 
          <field name="method"/> 
          <field name="query"/> 
      </tree> 
    </field> 
  </record> 
--> 



  <!-- Action to open KPI configuration
  <act_window id="config_pubble_kpi_connector" 
    name="Pubble KPI data connector config" 
    res_model="pubble.config" 
    view_mode="tree,form"
    /> 
-->
